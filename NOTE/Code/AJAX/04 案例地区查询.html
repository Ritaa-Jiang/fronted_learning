<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>04.案例_地区查询</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
  <style>
    :root {
      font-size: 15px;
    }

    body {
      padding-top: 15px;
    }
  </style>
</head>

<body>
  <div class="container">
    <form id="editForm" class="row">
      <!-- 输入省份名字 -->
      <div class="mb-3 col">
        <label class="form-label">省份名字</label>
        <input type="text" value="北京" name="province" class="form-control province" placeholder="请输入省份名称" />
      </div>
      <!-- 输入城市名字 -->
      <div class="mb-3 col">
        <label class="form-label">城市名字</label>
        <input type="text" value="北京市" name="city" class="form-control city" placeholder="请输入城市名称" />
      </div>
    </form>
    <button type="button" class="btn btn-primary sel-btn">查询</button>
    <br><br>
    <p>地区列表: </p>
    <ul class="list-group">
      <!-- 示例地区 -->
      <li class="list-group-item">东城区</li>
    </ul>
  </div>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script>
    /*
      获取地区列表: http://hmajax.itheima.net/api/area
      查询参数:
        pname: 省份或直辖市名字
        cname: 城市名字
    */
   // 目标：根据省份和城市名字 查询地区列表
   // 1.给按钮添加点击事件
   document.querySelector('.sel-btn').addEventListener('click',() => {
    // console.log('点击')
    // 检验事件绑定成功
    // 2.获取省份和城市名
    // 获取标签的class直接用f12就行 如果不是自己写html文件的话
    let pName = document.querySelector('.province').value
    // 获取值
    let cName = document.querySelector('.city').value
    // 先从本地网页获取接受用户输入的数据

    // 3.基于axios请求地区列表数据
    // 向服务器请求

    // 注意axios的结构 写的时候别把自己绕进去了
    
    axios({
        url:'http://hmajax.itheima.net/api/area',
        // 注意 上面那个pName是在前端写js代码时自定义的变量
        // 下面这个pname是后端所指定要求的参数命名
        params:{
            pname:pName,
            cname:cName
        }
    }).then(result => {
        // console.log(result)
        let list = result.data.list
        console.log(list)
        // *****把数组映射成字符串 
        // 下面这个是用f12复制的模板字符串
        // 目标 将省份列表这个字符串数组嵌入到页面内
        // 代码 使用map遍历数组里的每个字符串 记为变量areaname 嵌入li中
        // 学vue可以使用v-for 

        // let theLi = list.map(areaname => <li class="list-group-item">${areaname}</li>)
        // let theLi = list.map(areaname => <li class="list-group-item">${areaname}</li>).join('')
        // 忘记使用反引号包装了
        let theLi = list.map(areaname => `<li class="list-group-item">${areaname}</li>`).join('')
        // 使用join拼接成完整字符串（html代码） 放进对应标签内

        console.log(theLi)
        document.querySelector('.list-group').innerHTML = theLi
    })
   })

  </script>
</body>

</html>